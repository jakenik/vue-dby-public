webpackJsonp([16],{E21k:function(s,t,a){s.exports=a("aZes")},aZes:function(s,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h2",[s._v("axios请求封装")]),s._v(" "),s._m(0),s._v(" "),a("h4",[s._v("login登录请求")]),s._v(" "),a("demo-block",{staticClass:"demo-box",attrs:{jsfiddle:{html:'<template>\n  <base-button color="danger" @click="onClickRequest">点击发起登录请求</base-button>\n</template>\n\n',script:"\nexport default {\n  methods: {\n    onClickRequest () {\n      // 登录接口需要首次进入\n      this.$request.login( // 不管请求多少次只会发起一次请求 等请求回来后就会自动回调\n        { \n          data:{}, \n          succ(res){\n            let token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n",style:null}}},[a("div",{staticClass:"source",attrs:{slot:"source"},slot:"source"},[[a("base-button",{attrs:{color:"danger"},on:{click:s.onClickRequest}},[s._v("点击发起登录请求")])]],2),s._v(" "),a("div",{staticClass:"highlight",attrs:{slot:"highlight"},slot:"highlight"},[a("pre",{pre:!0},[a("code",{pre:!0,attrs:{class:"hljs language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("color")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"danger"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onClickRequest"')]),s._v(">")]),s._v("点击发起登录请求"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onClickRequest () {\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 登录接口需要首次进入")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$request.login( "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 不管请求多少次只会发起一次请求 等请求回来后就会自动回调")]),s._v("\n        { \n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(":{}, \n          succ(res){\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])])])]),s._v(" "),a("h4",[s._v("getToken获得token")]),s._v(" "),a("demo-block",{staticClass:"demo-box",attrs:{jsfiddle:{html:'<template>\n  <base-button color="danger" @click="onClickRequestToken">点击发起token请求</base-button>\n</template>\n\n',script:"\nexport default {\n  methods: {\n    onClickRequestToken() {\n      // 获取token \n      // 按照规则是：\n      // 1.当前url有token就用url的 \n      // 2.当前缓存是否有token有用缓存的\n      // 3.当前缓存url是否有code 有去登录\n      // 4.当前本地有没有token 有去检查token 然后再返回\n      this.$request.getToken( \n        { \n          data:{}, \n          succ(res){\n            let token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n",style:null}}},[a("div",{staticClass:"source",attrs:{slot:"source"},slot:"source"},[[a("base-button",{attrs:{color:"danger"},on:{click:s.onClickRequestToken}},[s._v("点击发起token请求")])]],2),s._v(" "),a("div",{staticClass:"highlight",attrs:{slot:"highlight"},slot:"highlight"},[a("pre",{pre:!0},[a("code",{pre:!0,attrs:{class:"hljs language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("color")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"danger"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onClickRequestToken"')]),s._v(">")]),s._v("点击发起token请求"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onClickRequestToken() {\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取token ")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 按照规则是：")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1.当前url有token就用url的 ")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 2.当前缓存是否有token有用缓存的")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3.当前缓存url是否有code 有去登录")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 4.当前本地有没有token 有去检查token 然后再返回")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$request.getToken( \n        { \n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(":{}, \n          succ(res){\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])])])]),s._v(" "),a("h4",[s._v("checkVisitor检查token")]),s._v(" "),a("demo-block",{staticClass:"demo-box",attrs:{jsfiddle:{html:'<template>\n  <base-button color="danger" @click="onClickCheckVisitor">检测token请求</base-button>\n</template>\n\n',script:"\nexport default {\n  methods: {\n    onClickCheckVisitor() {\n      this.$request.checkVisitor(\n        { \n          token: 'wangjiahui',\n          data:{}, \n          succ(res){\n            let token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n",style:null}}},[a("div",{staticClass:"source",attrs:{slot:"source"},slot:"source"},[[a("base-button",{attrs:{color:"danger"},on:{click:s.onClickCheckVisitor}},[s._v("检测token请求")])]],2),s._v(" "),a("div",{staticClass:"highlight",attrs:{slot:"highlight"},slot:"highlight"},[a("pre",{pre:!0},[a("code",{pre:!0,attrs:{class:"hljs language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("color")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"danger"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onClickCheckVisitor"')]),s._v(">")]),s._v("检测token请求"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    onClickCheckVisitor() {\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$request.checkVisitor(\n        { \n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("token")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'wangjiahui'")]),s._v(",\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(":{}, \n          succ(res){\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" token = res.token\n          }, fail(res){\n\n          } \n        }\n      )\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])])])]),s._v(" "),a("h4",[s._v("httpRequest发起请求")]),s._v(" "),a("demo-block",{staticClass:"demo-box",attrs:{jsfiddle:{html:'<template>\n  <base-button color="danger" @click="onClickHttpRequest">发起请求</base-button>\n</template>\n\n',script:"\nexport default {\n  methods: {\n    /**\n     * 用于http请求\n     * @param {*} { path, header, data, method, succ, fail, baseURL, clog }\n     * @param path当前地址\n     * @param header请求头\n     * @param data 参数\n     * @param method 请求方式\n     * @param succ 成功\n     * @param fail 失败\n     * @param baseURL 请求环境\n     * @param noToken 需不需要携带token默认需要\n     */\n    onClickHttpRequest() {\n      this.$request.httpRequest(\n        {\n          path: '/dome',\n          header: {},\n          data: {},\n          method: 'POST',\n          succ:(res)=> {\n            this.$toast('请求成功')\n          },\n          fail:(res)=> {\n            this.$toast('请求失败')\n          },\n          baseURL:this.$env.apiH5,\n          noToken: true\n        }\n      )\n    }\n  }\n}\n",style:null}}},[a("div",{staticClass:"source",attrs:{slot:"source"},slot:"source"},[[a("base-button",{attrs:{color:"danger"},on:{click:s.onClickHttpRequest}},[s._v("发起请求")])]],2),s._v(" "),a("div",{staticClass:"highlight",attrs:{slot:"highlight"},slot:"highlight"},[a("pre",{pre:!0},[a("code",{pre:!0,attrs:{class:"hljs language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("color")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"danger"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"onClickHttpRequest"')]),s._v(">")]),s._v("发起请求"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("base-button")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n     * 用于http请求\n     * @param {*} { path, header, data, method, succ, fail, baseURL, clog }\n     * @param path当前地址\n     * @param header请求头\n     * @param data 参数\n     * @param method 请求方式\n     * @param succ 成功\n     * @param fail 失败\n     * @param baseURL 请求环境\n     * @param noToken 需不需要携带token默认需要\n     */")]),s._v("\n    onClickHttpRequest() {\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$request.httpRequest(\n        {\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/dome'")]),s._v(",\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("header")]),s._v(": {},\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": {},\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("method")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'POST'")]),s._v(",\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("succ")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("res")]),s._v(")=>")]),s._v(" {\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$toast("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请求成功'")]),s._v(")\n          },\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fail")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("res")]),s._v(")=>")]),s._v(" {\n            "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$toast("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请求失败'")]),s._v(")\n          },\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("baseURL")]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$env.apiH5,\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("noToken")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n        }\n      )\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])])])])],1)},staticRenderFns:[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{class:"hljs language-javascript"}},[s._v("  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { Request } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'dby-base'")]),s._v("\n  Vue.use(Request)\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 访问 this.$request")]),s._v("\n")])])}]},e=a("C7Lr")({methods:{onClickRequest:function(){this.$request.login({data:{},succ:function(s){s.token},fail:function(s){}})},onClickRequestToken:function(){this.$request.getToken({data:{},succ:function(s){s.token},fail:function(s){}})},onClickCheckVisitor:function(){this.$request.checkVisitor({token:"wangjiahui",data:{},succ:function(s){s.token},fail:function(s){}})},onClickHttpRequest:function(){var s=this;this.$request.httpRequest({path:"/dome",header:{},data:{},method:"POST",succ:function(t){s.$toast("请求成功")},fail:function(t){s.$toast("请求失败")},baseURL:this.$env.apiH5,noToken:!0})}}},n,!1,null,null,null);t.default=e.exports}});
//# sourceMappingURL=16.091d08a907d981fdc0bd.js.map